#!/usr/bin/tclsh

package require Itcl

package require tcltest
namespace import tcltest::*

package require markdown

set DATA_DIR "[file dirname [file normalize $::argv0]]/data"

#
# TEST CASES
#

test ut_markdown {
    Test the markdown converter on various source files
} {
    -result 0
    -setup {
    }
    -body {

        foreach {doc} {bq code inline lists p_br_h_hr} {
            set markdown_file $DATA_DIR/markdown/$doc.text
            set html_file     $DATA_DIR/markdown/$doc.html

            set fp [open $markdown_file]
            set markdown [read $fp]
            close $fp

            set fp [open $html_file]
            set html [read $fp]
            close $fp

            set result [::markdown::convert $markdown]

            if {$result ne $html} {
                error "conversion of '$markdown_file' didn't \
                    produce expected result"
            }
        }

        return 0
    }
}

