#!/usr/bin/tclsh

package require tcltest
namespace import tcltest::*

package require WebDriver
package require OOSupport
namespace import OOSupport::*

#
# PREAMBLE
#

set REQUIRED_CAPABILITIES_JSON \
{{
	"browserName": "chrome"
}}

set CAPABILITIES_JSON \
{{
	"browserName": "firefox",
	"javascriptEnabled": true,
	"takesScreenshot": true,
	"handlesAlerts": true,
	"databaseEnabled": true,
	"locationContextEnabled": true,
	"applicationCacheEnabled": true,
	"browserConnectionEnabled": true,
	"cssSelectorsEnabled": true,
	"webStorageEnabled": true,
	"rotatable": true,
	"acceptSslCerts": true,
	"nativeEvents": false,
	"proxy":
	{
		"proxyType": "direct"
	}
}}

#
# TEST CASES
#

test ut_webdriver_capabilities {
    Set browser name to 'firefox' and dump as JSON
} {
    -result 0
    -setup {
        set cap [WebDriver::Capabilities new]
        $cap set_browser_name firefox
    }
    -body {
        if {[$cap to_json] == $CAPABILITIES_JSON} {
            return 0
        }

        puts [$cap to_json]

        error "error in JSON"
    }
}

test ut_webdriver_required_capabilities {
    Set browser name to 'chrome' and dump as JSON
} {
    -result 0
    -setup {
        set req_cap [WebDriver::RequiredCapabilities #auto]
        $req_cap set_browser_name chrome
    }
    -body {
        if {[$req_cap to_json] == $REQUIRED_CAPABILITIES_JSON} {
            return 0
        }

        error "error in JSON"
    }
}

