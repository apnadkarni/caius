#!/usr/bin/tclsh

package require Itcl

package require tcltest
namespace import tcltest::*

package require OOSupport
namespace import OOSupport::*

#
# PREAMBLE
#

::itcl::class ObjectA {

    common attributes {
        {[string]  strings  {}  rw}
    }

    method constructor {} {
        init_attributes
    }

    bless_attributes -json_support
}

set JSON \
{{
	"strings":
	[
		"the sky is the limit...", "°!§$%&\n/{}\"\\()=?", "n\ne\nw\nl\ni\nn\ne"
	]
}}

#
# TEST CASES
#

test ut_oosupport_json_strings {
    Test JSON string escaping
} {
    -result 0
    -setup {
        set obj_a [ObjectA #auto]
        $obj_a from_json $JSON
    }
    -body {
        if {[$obj_a to_json] != $JSON} {
            error "error in JSON"
        }

        return 0
    }
}

